# -*- coding: utf-8 -*-
"""making dataset from ipl 11

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bUsNbWN0geZTO-biDtKT48YRevMzm1_n
"""

import pandas as pd
import numpy as np

auction_df = pd.read_csv('/content/drive/MyDrive/ipl dataset/ipl_2025_auction_players.csv')
batting_df = pd.read_csv('/content/drive/MyDrive/ipl dataset/ipl_player_stats_csv.txt')
bowling_df = pd.read_csv('/content/drive/MyDrive/ipl dataset/bowling_stats_csv.txt')
impact_df = pd.read_csv('/content/drive/MyDrive/ipl dataset/ipl_player_data_csv.txt')

merged_df = pd.merge(batting_df, bowling_df, left_on='Player Name', right_on='Player_Name', how='outer')
merged_df = pd.merge(merged_df, auction_df, left_on='Player Name', right_on='Players', how='left')

merged_df.head()

df = merged_df.sort_values(by='Sold', ascending=False)

df.head()

df_filtered = df[~df['Sold'].isin(['Unsold' , 'TBA'])].copy()
df_filtered.head()

df = df_filtered.drop(['Rank_x' , 'Rank_y' , 'Team_x' ,'Player_Name' , 'Team_y', 'Unnamed: 8' , 'Players'], axis=1)

df['Sold_Price'] = pd.to_numeric(df['Sold'], errors='coerce')
highest_price_player = df.sort_values(by='Sold_Price', ascending=False).iloc[0]
print("Player sold at the highest price:")
print(highest_price_player[['Player Name', 'Sold_Price']])

df = df.sort_values(by='Sold_Price', ascending=False)
df.head()

df.index = df.index + 1
df = df.drop('Sold_Price' , axis =1)
df.head()

df = pd.read_csv('/content/drive/MyDrive/ipl dataset/Final Data.csv')
df_1 = pd.read_csv('/content/drive/MyDrive/ipl dataset/ipl_player_data_csv.txt')

# prompt: add a column in df from df_1 that is total impact

df_1_renamed = df_1.rename(columns={'Player': 'Player Name'})
df['Total_Impact'] = df['Player Name'].map(df_1_renamed.set_index('Player Name')['Total_Impact'])
df.head()

df.to_csv('Final Data Ipl.csv', index=False)

print(df.columns)

# prompt: download df

files.download('Final Data Ipl.csv')

